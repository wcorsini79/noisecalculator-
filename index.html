<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Exposi√ß√£o Auditiva - FPSO Bacalhau</title>
    <style>
        :root {
            --verde: #4CAF50;
            --amarelo: #FFC107;
            --laranja: #FF9800;
            --vermelho: #F44336;
            --cinza-claro: #f5f5f5;
            --cinza-escuro: #333;
            --azul-profissional: #2196F3;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f0f2f5;
            color: #333;
            line-height: 1.6;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            background-color: var(--azul-profissional);
            color: white;
            padding: 20px;
            border-radius: 8px 8px 0 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        h1 {
            font-size: 1.8rem;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1rem;
            opacity: 0.9;
        }
        
        .card {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .input-section {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .input-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        label {
            font-weight: 600;
            color: var(--cinza-escuro);
        }
        
        input[type="number"] {
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
            width: 100%;
        }
        
        .range-info {
            display: flex;
            justify-content: space-between;
            font-size: 0.8rem;
            color: #666;
        }
        
        button {
            background-color: var(--azul-profissional);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: background-color 0.3s;
        }
        
        button:hover {
            background-color: #1976D2;
        }
        
        .results-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        @media (max-width: 768px) {
            .results-section {
                grid-template-columns: 1fr;
            }
        }
        
        .result-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        
        .result-table th, .result-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        .result-table th {
            background-color: var(--cinza-claro);
            font-weight: 600;
        }
        
        .status-conformidade {
            font-weight: 600;
            padding: 5px 10px;
            border-radius: 4px;
            display: inline-block;
        }
        
        .seguro {
            background-color: var(--verde);
            color: white;
        }
        
        .atencao {
            background-color: var(--amarelo);
            color: black;
        }
        
        .perigo {
            background-color: var(--vermelho);
            color: white;
        }
        
        .limite {
            background-color: var(--laranja);
            color: white;
        }
        
        .report-section {
            margin-top: 20px;
        }
        
        .report-header {
            background-color: var(--cinza-escuro);
            color: white;
            padding: 15px;
            border-radius: 4px 4px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .report-content {
            padding: 20px;
            border: 1px solid #ddd;
            border-top: none;
            border-radius: 0 0 4px 4px;
            background-color: white;
        }
        
        .section-title {
            margin-top: 20px;
            margin-bottom: 10px;
            padding-bottom: 5px;
            border-bottom: 1px solid #ddd;
            color: var(--azul-profissional);
        }
        
        .alert-box {
            padding: 15px;
            border-radius: 4px;
            margin: 15px 0;
            font-weight: 600;
        }
        
        .alert-info {
            background-color: #e3f2fd;
            border-left: 4px solid var(--azul-profissional);
        }
        
        .alert-warning {
            background-color: #fff8e1;
            border-left: 4px solid var(--amarelo);
        }
        
        .alert-danger {
            background-color: #ffebee;
            border-left: 4px solid var(--vermelho);
        }
        
        .copy-button {
            background-color: #6c757d;
            margin-top: 10px;
        }
        
        .copy-button:hover {
            background-color: #5a6268;
        }
        
        .normas-list {
            list-style-type: none;
            padding-left: 0;
        }
        
        .normas-list li {
            padding: 5px 0;
            border-bottom: 1px solid #eee;
        }
        
        .normas-list li:before {
            content: "‚Ä¢";
            color: var(--azul-profissional);
            font-weight: bold;
            display: inline-block;
            width: 1em;
            margin-left: -1em;
        }
        
        .disclaimer {
            font-size: 0.9rem;
            font-style: italic;
            margin-top: 20px;
            padding: 15px;
            background-color: #f9f9f9;
            border-radius: 4px;
            border-left: 4px solid #6c757d;
        }
        
        .formula-box {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 4px;
            margin: 15px 0;
            border-left: 4px solid var(--azul-profissional);
            font-family: monospace;
        }
        
        .protecao-info {
            background-color: #e8f5e8;
            padding: 15px;
            border-radius: 4px;
            margin: 15px 0;
            border-left: 4px solid var(--verde);
        }
        
        .input-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        @media (max-width: 768px) {
            .input-row {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Calculadora de Exposi√ß√£o Auditiva - FPSO Bacalhau</h1>
            <p class="subtitle">C√°lculos baseados na NR-15, ABNT NBR ISO 1999 e ISO 9612</p>
	<p class="subtitle">por Wilkinson Corsini</p>
        </header>
        
        <div class="card">
            <div class="input-section">
                <div class="input-row">
                    <div class="input-group">
                        <label for="ruido">N√≠vel de Ru√≠do (dB):</label>
                        <input type="number" id="ruido" min="70" max="140" step="0.1" placeholder="Ex: 85.5">
                        <div class="range-info">
                            <span>M√≠nimo: 70 dB</span>
                            <span>M√°ximo: 140 dB</span>
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <label for="protecao">N√≠vel de Prote√ß√£o Auditiva (dB):</label>
                        <input type="number" id="protecao" min="0" max="40" step="0.1" value="0" placeholder="Ex: 25.0">
                        <div class="range-info">
                            <span>M√≠nimo: 0 dB</span>
                            <span>M√°ximo: 40 dB</span>
                        </div>
                    </div>
                </div>
                <button id="calcular">Calcular Exposi√ß√£o</button>
            </div>
        </div>
        
        <div id="resultados" style="display: none;">
            <div class="results-section">
                <div class="card">
                    <h2>Tabela 1 - Resultados 8 Horas (Conforme NR-15)</h2>
                    <table class="result-table">
                        <tr>
                            <th>Par√¢metro</th>
                            <th>Valor</th>
                        </tr>
                        <tr>
                            <td>N√≠vel de Ru√≠do Inserido</td>
                            <td id="nivel-ruido">-</td>
                        </tr>
                        <tr>
                            <td>N√≠vel com Prote√ß√£o</td>
                            <td id="nivel-com-protecao">-</td>
                        </tr>
                        <tr>
                            <td>N√≠vel de A√ß√£o (NR-15)</td>
                            <td>80 dB</td>
                        </tr>
                        <tr>
                            <td>Limite de Exposi√ß√£o (NR-15)</td>
                            <td>85 dB</td>
                        </tr>
                        <tr>
                            <td>Dose Di√°ria Calculada</td>
                            <td id="dose-8h">-</td>
                        </tr>
                        <tr>
                            <td>Status de Conformidade</td>
                            <td id="status-8h">-</td>
                        </tr>
                        <tr>
                            <td>Tempo M√°ximo Permitido</td>
                            <td id="tempo-maximo">-</td>
                        </tr>
                        <tr>
                            <td>Prote√ß√£o Auditiva Necess√°ria</td>
                            <td id="protecao-8h">-</td>
                        </tr>
                    </table>
                </div>
                
                <div class="card">
                    <h2>Tabela 2 - Simula√ß√£o 12 Horas</h2>
                    <table class="result-table">
                        <tr>
                            <th>Par√¢metro</th>
                            <th>Valor</th>
                        </tr>
                        <tr>
                            <td>N√≠vel de Ru√≠do (mesmo)</td>
                            <td id="nivel-ruido-12h">-</td>
                        </tr>
                        <tr>
                            <td>N√≠vel com Prote√ß√£o</td>
                            <td id="nivel-com-protecao-12h">-</td>
                        </tr>
                        <tr>
                            <td>Limite Equivalente 12h</td>
                            <td id="limite-12h">-</td>
                        </tr>
                        <tr>
                            <td>Dose Acumulada (12h)</td>
                            <td id="dose-12h">-</td>
                        </tr>
                        <tr>
                            <td>Exced√™ncia vs. Limite</td>
                            <td id="excedencia">-</td>
                        </tr>
                        <tr>
                            <td>Risco Auditivo Potencial</td>
                            <td id="risco-12h">-</td>
                        </tr>
                        <tr>
                            <td>Recomenda√ß√£o</td>
                            <td id="recomendacao-12h">-</td>
                        </tr>
                        <tr>
                            <td>Monitoramento Auditivo</td>
                            <td id="monitoramento-12h">-</td>
                        </tr>
                    </table>
                </div>
            </div>
            
            <div class="card report-section">
                <div class="report-header">
                    <h2>Relat√≥rio T√©cnico de Exposi√ß√£o Auditiva</h2>
                    <button class="copy-button" id="copiar-relatorio">Copiar Relat√≥rio</button>
                </div>
                <div class="report-content" id="relatorio-tecnico">
                    <!-- Conte√∫do do relat√≥rio ser√° preenchido via JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const calcularBtn = document.getElementById('calcular');
            const copiarBtn = document.getElementById('copiar-relatorio');
            const resultadosDiv = document.getElementById('resultados');
            const ruidoInput = document.getElementById('ruido');
            const protecaoInput = document.getElementById('protecao');
            
            calcularBtn.addEventListener('click', calcularExposicao);
            copiarBtn.addEventListener('click', copiarRelatorio);
            
            function calcularExposicao() {
                // Obter e validar os valores de entrada
                const nivelRuido = parseFloat(ruidoInput.value);
                const nivelProtecao = parseFloat(protecaoInput.value);
                
                if (isNaN(nivelRuido) || nivelRuido < 70 || nivelRuido > 140) {
                    alert('Por favor, insira um valor v√°lido entre 70 e 140 dB.');
                    return;
                }
                
                if (isNaN(nivelProtecao) || nivelProtecao < 0 || nivelProtecao > 40) {
                    alert('Por favor, insira um valor v√°lido entre 0 e 40 dB para prote√ß√£o.');
                    return;
                }
                
                // Calcular n√≠vel efetivo com prote√ß√£o
                const nivelEfetivo = nivelRuido - nivelProtecao;
                
                // Calcular dose para 8 horas (regra de redu√ß√£o pela metade a cada 5 dB)
                const dose8h = calcularDose8Horas(nivelEfetivo);
                const status8h = determinarStatusConformidade(dose8h);
                const tempoMaximo = calcularTempoMaximo(nivelEfetivo);
                const protecao8h = nivelEfetivo >= 80 ? 'SIM' : 'N√ÉO';
                
                // Calcular dose para 12 horas usando interpola√ß√£o linear
                const limite12h = calcularLimite12Horas();
                const dose12h = calcularDose12Horas(nivelEfetivo, limite12h);
                const excedencia = calcularExcedencia(dose12h);
                const risco12h = determinarRisco(dose12h);
                const recomendacao12h = determinarRecomendacao(nivelEfetivo, dose12h);
                const monitoramento12h = determinarMonitoramento(nivelEfetivo);
                
                // Atualizar a Tabela 1
                document.getElementById('nivel-ruido').textContent = nivelRuido + ' dB';
                document.getElementById('nivel-com-protecao').textContent = nivelEfetivo.toFixed(1) + ' dB';
                document.getElementById('dose-8h').textContent = dose8h.toFixed(1) + '%';
                document.getElementById('status-8h').innerHTML = formatarStatus(status8h);
                document.getElementById('tempo-maximo').textContent = tempoMaximo;
                document.getElementById('protecao-8h').textContent = protecao8h;
                
                // Atualizar a Tabela 2
                document.getElementById('nivel-ruido-12h').textContent = nivelRuido + ' dB';
                document.getElementById('nivel-com-protecao-12h').textContent = nivelEfetivo.toFixed(1) + ' dB';
                document.getElementById('limite-12h').textContent = limite12h.toFixed(1) + ' dB';
                document.getElementById('dose-12h').textContent = dose12h.toFixed(1) + '%';
                document.getElementById('excedencia').textContent = excedencia;
                document.getElementById('risco-12h').textContent = risco12h;
                document.getElementById('recomendacao-12h').textContent = recomendacao12h;
                document.getElementById('monitoramento-12h').textContent = monitoramento12h;
                
                // Gerar relat√≥rio t√©cnico
                gerarRelatorioTecnico(nivelRuido, nivelProtecao, nivelEfetivo, dose8h, dose12h, status8h, limite12h);
                
                // Mostrar resultados
                resultadosDiv.style.display = 'block';
            }
            
            function calcularDose8Horas(nivelEfetivo) {
                // F√≥rmula baseada na redu√ß√£o pela metade a cada 5 dB
                // Tempo m√°ximo permitido = 8 * 2^((85 - nivelEfetivo)/5)
                if (nivelEfetivo <= 85) {
                    return 100; // 100% no limite de 85 dB
                }
                
                const tempoPermitido = 8 * Math.pow(2, (85 - nivelEfetivo) / 5);
                return (8 / tempoPermitido) * 100;
            }
            
            function calcularLimite12Horas() {
                // Interpola√ß√£o linear entre 8h (85 dB) e 16h (80 dB)
                // Taxa: 5 dB para 8 horas de diferen√ßa = 0,625 dB por hora
                // 12h = 4h a mais que 8h ‚Üí 85 - (4 * 0,625) = 82,5 dB
                return 85 - (4 * 0.625);
            }
            
            function calcularDose12Horas(nivelEfetivo, limite12h) {
                if (nivelEfetivo <= limite12h) {
                    return 100; // 100% no limite equivalente
                }
                
                // Tempo m√°ximo permitido para 12h = 12 * 2^((limite12h - nivelEfetivo)/5)
                const tempoPermitido = 12 * Math.pow(2, (limite12h - nivelEfetivo) / 5);
                return (12 / tempoPermitido) * 100;
            }
            
            function determinarStatusConformidade(dose) {
                // Verde para 100% ou menos (conforme solicitado)
                if (dose <= 100) return 'seguro';
                if (dose <= 150) return 'atencao';
                return 'perigo';
            }
            
            function calcularTempoMaximo(nivelEfetivo) {
                if (nivelEfetivo <= 85) return '8 horas';
                
                // Tempo m√°ximo = 8 * 2^((85 - nivelEfetivo)/5)
                const tempo = 8 * Math.pow(2, (85 - nivelEfetivo) / 5);
                
                // Converter para horas e minutos
                const horas = Math.floor(tempo);
                const minutos = Math.round((tempo - horas) * 60);
                
                if (minutos === 0) {
                    return `${horas} horas`;
                } else {
                    return `${horas}h ${minutos}min`;
                }
            }
            
            function calcularExcedencia(dose12h) {
                const excedencia = dose12h - 100;
                if (excedencia <= 0) return '0%';
                return '+' + excedencia.toFixed(1) + '%';
            }
            
            function determinarRisco(dose12h) {
                if (dose12h <= 100) return 'BAIXO';
                if (dose12h <= 150) return 'MODERADO';
                if (dose12h <= 200) return 'ALTO';
                return 'MUITO ALTO';
            }
            
            function determinarRecomendacao(nivelEfetivo, dose12h) {
                if (nivelEfetivo < 80) return 'EPIs conforme avalia√ß√£o';
                if (dose12h <= 100) return 'EPIs obrigat√≥rios';
                return 'EPIs+EPC obrigat√≥rios';
            }
            
            function determinarMonitoramento(nivelEfetivo) {
                if (nivelEfetivo < 80) return 'BIENAL';
                if (nivelEfetivo < 85) return 'ANUAL';
                return 'SEMESTRAL';
            }
            
            function formatarStatus(status) {
                const classes = {
                    'seguro': 'seguro',
                    'atencao': 'atencao',
                    'perigo': 'perigo'
                };
                
                const textos = {
                    'seguro': 'CONFORME',
                    'atencao': 'ATEN√á√ÉO',
                    'perigo': 'N√ÉO CONFORME'
                };
                
                return `<span class="status-conformidade ${classes[status]}">${textos[status]}</span>`;
            }
            
            function sugerirProtecao(nivelRuido, nivelProtecaoAtual) {
                let sugestao = '';
                let tipoProtecao = '';
                let nivelRecomendado = 0;
                
                if (nivelRuido <= 85) {
                    tipoProtecao = 'Protetor auricular inser√≠vel (plug)';
                    nivelRecomendado = 15;
                } else if (nivelRuido <= 95) {
                    tipoProtecao = 'Protetor auricular circum-auricular (concha)';
                    nivelRecomendado = 25;
                } else if (nivelRuido <= 105) {
                    tipoProtecao = 'Protetor auricular circum-auricular de alta atenua√ß√£o';
                    nivelRecomendado = 30;
                } else {
                    tipoProtecao = 'Dupla prote√ß√£o (plug + concha)';
                    nivelRecomendado = 35;
                }
                
                const diferenca = nivelRecomendado - nivelProtecaoAtual;
                
                if (diferenca > 5) {
                    sugestao = `‚ö†Ô∏è <strong>Sugest√£o de melhoria:</strong> Recomenda-se ${tipoProtecao} com atenua√ß√£o de ${nivelRecomendado} dB (${diferenca.toFixed(1)} dB a mais que o atual)`;
                } else if (diferenca < -5) {
                    sugestao = `‚úÖ <strong>Prote√ß√£o adequada:</strong> ${tipoProtecao} atual est√° dentro do recomendado`;
                } else {
                    sugestao = `‚ÑπÔ∏è <strong>Prote√ß√£o satisfat√≥ria:</strong> ${tipoProtecao} atual est√° pr√≥xima do recomendado (${nivelRecomendado} dB)`;
                }
                
                return {
                    sugestao: sugestao,
                    tipo: tipoProtecao,
                    nivelRecomendado: nivelRecomendado
                };
            }
            
            function gerarRelatorioTecnico(nivelRuido, nivelProtecao, nivelEfetivo, dose8h, dose12h, status, limite12h) {
                const relatorio = document.getElementById('relatorio-tecnico');
                const dataAtual = new Date().toLocaleDateString('pt-BR');
                const sugestaoProtecao = sugerirProtecao(nivelRuido, nivelProtecao);
                
                // Cabe√ßalho
                let html = `
                    <div class="report-header-info">
                        <h2>Relat√≥rio T√©cnico de Exposi√ß√£o Auditiva</h2>
                        <p><strong>Plataforma:</strong> FPSO Bacalhau</p>
                        <p><strong>Data do c√°lculo:</strong> ${dataAtual}</p>
                        <p><strong>Calculadora vers√£o:</strong> 1.2 - Baseada em NR-15/ISO 9612/ISO 1999</p>
                    </div>
                `;
                
                // Se√ß√£o 1: Par√¢metros Inseridos
                html += `
                    <div class="section-title">SE√á√ÉO 1: PAR√ÇMETROS INSERIDOS</div>
                    <ul>
                        <li><strong>N√≠vel de ru√≠do informado:</strong> ${nivelRuido} dB(A)</li>
                        <li><strong>N√≠vel de prote√ß√£o auditiva:</strong> ${nivelProtecao} dB</li>
                        <li><strong>N√≠vel efetivo de exposi√ß√£o:</strong> ${nivelEfetivo.toFixed(1)} dB(A)</li>
                        <li><strong>Per√≠odo de avalia√ß√£o:</strong> 8 e 12 horas</li>
                        <li><strong>Base normativa:</strong> NR-15 / ISO 9612</li>
                    </ul>
                `;
                
                // Se√ß√£o 2: Resultados T√©cnicos
                html += `
                    <div class="section-title">SE√á√ÉO 2: RESULTADOS T√âCNICOS</div>
                    <ul>
                        <li><strong>Dose para 8h:</strong> ${dose8h.toFixed(1)}%</li>
                        <li><strong>Limite equivalente para 12h:</strong> ${limite12h.toFixed(1)} dB</li>
                        <li><strong>Dose para 12h:</strong> ${dose12h.toFixed(1)}%</li>
                        <li><strong>Avalia√ß√£o de conformidade:</strong> ${formatarStatus(status)}</li>
                    </ul>
                    
                    <div class="formula-box">
                        <strong>F√≥rmulas utilizadas:</strong><br>
                        ‚Ä¢ N√≠vel Efetivo = N√≠vel Ru√≠do - Prote√ß√£o Auditiva<br>
                        ‚Ä¢ Dose 8h = (8 / [8 √ó 2^((85 - N√≠velEfetivo)/5)]) √ó 100<br>
                        ‚Ä¢ Limite 12h = 85 - (4 √ó 0,625) = 82,5 dB<br>
                        ‚Ä¢ Dose 12h = (12 / [12 √ó 2^((82,5 - N√≠velEfetivo)/5)]) √ó 100
                    </div>
                `;
                
                // Se√ß√£o 3: An√°lise de Prote√ß√£o Auditiva
                html += `
                    <div class="section-title">SE√á√ÉO 3: AN√ÅLISE DE PROTE√á√ÉO AUDITIVA</div>
                    <div class="protecao-info">
                        ${sugestaoProtecao.sugestao}
                        <br><br>
                        <strong>Detalhamento:</strong>
                        <ul>
                            <li><strong>Tipo recomendado:</strong> ${sugestaoProtecao.tipo}</li>
                            <li><strong>N√≠vel de atenua√ß√£o recomendado:</strong> ${sugestaoProtecao.nivelRecomendado} dB</li>
                            <li><strong>N√≠vel atual utilizado:</strong> ${nivelProtecao} dB</li>
                            <li><strong>Redu√ß√£o efetiva no n√≠vel de exposi√ß√£o:</strong> ${(nivelRuido - nivelEfetivo).toFixed(1)} dB</li>
                        </ul>
                    </div>
                `;
                
                // Se√ß√£o 4: Interpreta√ß√£o Normativa
                html += `
                    <div class="section-title">SE√á√ÉO 4: INTERPRETA√á√ÉO NORMATIVA</div>
                `;
                
                if (dose8h <= 100) {
                    html += `
                        <div class="alert-box alert-info">
                            ‚úÖ CONFORME COM NR-15. Exposi√ß√£o dentro dos limites permitidos para 8 horas.
                        </div>
                    `;
                } else if (dose8h <= 150) {
                    html += `
                        <div class="alert-box alert-warning">
                            ‚ö†Ô∏è ATEN√á√ÉO - Pr√≥ximo ao limite. EPIs obrigat√≥rios. Reavaliar condi√ß√µes de trabalho.
                        </div>
                    `;
                } else {
                    html += `
                        <div class="alert-box alert-danger">
                            üî¥ N√ÉO CONFORME - ACIMA DO LIMITE. EPIs obrigat√≥rios imediatos. Avalia√ß√£o audiom√©trica semestral.
                        </div>
                    `;
                }
                
                // Se√ß√£o 5: Recomenda√ß√µes
                html += `
                    <div class="section-title">SE√á√ÉO 5: RECOMENDA√á√ïES</div>
                `;
                
                // Frequ√™ncia de monitoramento
                let frequenciaMonitoramento = '';
                if (nivelEfetivo < 80) {
                    frequenciaMonitoramento = 'Bienal (a cada 2 anos)';
                } else if (nivelEfetivo < 85) {
                    frequenciaMonitoramento = 'Anual';
                } else {
                    frequenciaMonitoramento = 'Semestral';
                }
                
                // Pr√≥ximas a√ß√µes
                let proximasAcoes = '';
                if (dose8h <= 100) {
                    proximasAcoes = 'Manter condi√ß√µes atuais. Reavaliar em caso de mudan√ßas no ambiente.';
                } else if (dose8h <= 150) {
                    proximasAcoes = 'Implementar Programa de Conserva√ß√£o Auditiva. Fornecer EPIs adequados.';
                } else {
                    proximasAcoes = 'A√ß√µes imediatas: Implementar controles de engenharia, revisar EPIs, realizar audiometria.';
                }
                
                html += `
                    <ul>
                        <li><strong>Frequ√™ncia de monitoramento audiom√©trico:</strong> ${frequenciaMonitoramento}</li>
                        <li><strong>Pr√≥ximas a√ß√µes recomendadas:</strong> ${proximasAcoes}</li>
                        <li><strong>Treinamento obrigat√≥rio:</strong> Uso correto e manuten√ß√£o de EPIs</li>
                        <li><strong>Inspe√ß√µes regulares:</strong> Verifica√ß√£o da integridade dos protetores auditivos</li>
                    </ul>
                `;
                
                // Normas e Refer√™ncias
                html += `
                    <div class="section-title">NORMAS E REFER√äNCIAS APLICADAS</div>
                    <ul class="normas-list">
                        <li>NR-15 Anexo 1 (Brasil) - Limite 85 dB(A) para 8h</li>
                        <li>ISO 9612:2009 - M√©todos de medi√ß√£o</li>
                        <li>ISO 1999:2013 - Audiometria ocupacional</li>
                        <li>NR-6 - Equipamentos de Prote√ß√£o Individual</li>
                        <li>Resolu√ß√£o CEREST - Monitoramento de sa√∫de auditiva</li>
                        <li>Estudos recentes de prote√ß√£o auditiva (2023-2024)</li>
                    </ul>
                `;
                
                // Disclaimer
                html += `
                    <div class="disclaimer">
                        <strong>Interpreta√ß√£o Final:</strong> Este c√°lculo √© baseado em dados t√©cnicos e legisla√ß√£o vigente. 
                        Recomenda-se valida√ß√£o com especialista em higiene ocupacional e audiometria ocupacional para 
                        decis√µes finais sobre programa de conserva√ß√£o auditiva.
                    </div>
                `;
                
                relatorio.innerHTML = html;
            }
            
            function copiarRelatorio() {
                const relatorio = document.getElementById('relatorio-tecnico');
                const range = document.createRange();
                range.selectNode(relatorio);
                window.getSelection().removeAllRanges();
                window.getSelection().addRange(range);
                
                try {
                    const successful = document.execCommand('copy');
                    if (successful) {
                        alert('Relat√≥rio copiado para a √°rea de transfer√™ncia!');
                    } else {
                        alert('Falha ao copiar o relat√≥rio. Tente novamente.');
                    }
                } catch (err) {
                    alert('Erro ao copiar o relat√≥rio: ' + err);
                }
                
                window.getSelection().removeAllRanges();
            }
        });
    </script>
</body>
</html>